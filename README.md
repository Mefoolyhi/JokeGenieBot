# JokeGenieBot

Telegram-бот для рекомендации анекдотов на основе предыдущих оценок пользователя

## Наборы данных
- [Jester Dataset №3](https://eigentaste.berkeley.edu/dataset/). 2.3 миллиона оценок 150 анекдотов на английском языке значениями от -10.00 до +10.00 от 73 421 пользователей, собранные с Апреля 1999 по Май 2003
- [120 тысяч анекдотов на русском языке](https://archive.org/details/120_tysyach_anekdotov)
- [Около 50 тысяч анекдотов на русском языке с Hugging Face](https://huggingface.co/datasets/inkoziev/jokes_dialogues)

## Алгоритм
- Использует Sentence BERT для построения embedding
- Использует индекс Faiss и косинусное расстояние для поиска наиболее похожих текстов на последние 5 анекдотов, которые понравились пользователю
- Из топ-10 похожих убираются те, которые пользователь уже видел
- Из всех анекдотов, которые пользователю не понравились, с помощью TF-IDF достаются самые частотные "ключевые" слова
- Из оставшегося списка анекдотов-кандидатов для показа убираются те, которые содержат ключевые слова из непонравившихся анекдотов
- Из оставшегося списка выбирается любой анекдот. Таким образом он максимально похож на последние понравившиеся, пользователь его еще не видел, и он не содержит ключевых слов из непонравившихся анекдотов

Для холодного старта берется любой анекдот. Если непонравившихся анекдотов нет, то берется любой из топ-10 похожих на понравившиеся

## Метрики

Бизнес-метрики:
- % лайков для анекдотов, отдельно для холодного старта
- % рандомной выдачи вместо рекомендации
- % покрытия

Технические метрики:
- Косинусное расстояние между понравившимся анекдотом и рекомендуемым
- Время работы
- Количество "ключевых" слов

## Файлы
- backend.ipynb -- содержит код для самого Telegram-бота
- jokes.ipynb -- анализ данных, эксперименты с обучением
- faiss_usage.ipynb -- финальный код рекомендации


## Список литературы
- [Sentence BERT](https://arxiv.org/abs/1908.10084). Sentence-BERT: Sentence Embeddings using Siamese BERT-Networks. N. Reimers, I. Gurevych (2019)
- [Faiss](https://github.com/facebookresearch/faiss)
- Ni J, Cai Y, Tang G, Xie Y. Collaborative Filtering Recommendation Algorithm Based on TF-IDF and User Characteristics. Applied Sciences. 2021; 11(20):9554. https://doi.org/10.3390/app11209554
